# ForgeFlow Log

Last updated: 2026-02-20

## 2026-02-11
- Initialized project log file.
- Step 1 completed: CSV ingestion pipeline runs from `main.py`.
- Step 2 completed: structured parsing and validation.
- Added `read_csv_records` to convert rows into typed records (`int`, `float`, `str`).
- Added CSV quality stats: `total_data_rows`, `valid_rows`, `skipped_bad_rows`.
- Verified by running `python main.py`.

## 2026-02-14
- Step 3A completed: added domain adapter skeleton for domain-specific mapping.
- Added `forgeflow/adapters/base.py` with adapter protocol and required-field validation.
- Added `forgeflow/adapters/tabular.py` as the first concrete adapter.
- Updated `main.py` to run records through adapter states before output.
- Added adapter stats: `total_records`, `valid_states`, `skipped_state_rows`.
- Added focused inline comments on adapter contract, fail-fast schema checks, and state-mapping flow.
- Step 3B completed: converted adapter states into model-ready numeric feature vectors.
- Extended adapter protocol with `feature_names`, `to_feature_vector`, and `build_feature_matrix`.
- Added feature stats: `total_states`, `valid_vectors`, `skipped_feature_rows`, `n_features`.
- Step 4 completed: added next-step supervised dataset builder (`x_t -> x_{t+1}`).
- Step 5 started: added linear dynamics baseline model with `fit/predict/MAE`.
- Updated `main.py` to train and report baseline results on generated supervised samples.
- Added `forgeflow/Input/test/linear_xy.csv` as pure numeric sanity-check data (`y = 2x + 1`).
- Added `forgeflow/adapters/linear_xy.py` for direct feature/target extraction from tabular rows.
- Added `linear_demo.py` to validate baseline linear fitting on the new CSV.
- Simplified entrypoint: `main.py` now runs only the linear sanity-check workflow.
- Removed redundant demo file `linear_demo.py` and old placeholder test file `forgeflow/metrics/test/test.py`.
- Added `forgeflow/metrics/split.py` to perform deterministic train/validation split.
- Updated `main.py` to report both `train_mae` and `val_mae` instead of train-only error.
- Added inference dataset `forgeflow/Input/test/linear_xy_infer.csv` (x-only).
- Extended `LinearXYAdapter` with infer feature builders for unlabeled records.
- Updated `main.py` to run post-training inference and save predictions to `forgeflow/Output/predictions.csv`.
- Added `forgeflow/evaluation/anomaly.py` with 3-sigma residual detector (`ResidualSigmaRule`).
- Updated `main.py` to fit anomaly thresholds from validation residuals and emit anomaly fields in prediction output.
- Note: current inference CSV is x-only, so anomaly fields are not fully verifiable until y labels are provided.
- Added `forgeflow/evaluation/metrics.py` for MAE/RMSE/MaxAE calculation.
- Added `forgeflow/evaluation/policy.py` for task-level eval thresholds and PASS/FAIL gating.
- Updated `main.py` to write evaluation summary to `forgeflow/Output/eval_report.csv`.
- Updated `forgeflow/Input/test/linear_xy_infer.csv` with optional y labels to validate anomaly flagging behavior.
- Added configuration system (`forgeflow/config/runtime.py`) and default config file (`forgeflow/config/linear_xy.json`).
- Updated `main.py` to support `--config`, adapter/model registry lookup, and config-driven paths/thresholds.
- Added noisy scenario files: `forgeflow/Input/test/linear_xy_noisy.csv` and `forgeflow/Input/test/linear_xy_noisy_infer.csv`.
- Added noisy task config: `forgeflow/config/linear_xy_noisy.json`.
- Verified noisy run via `python main.py --config forgeflow/config/linear_xy_noisy.json` (PASS; 2 anomalies flagged).
- Framework refactor completed: introduced `forgeflow/core`, `forgeflow/interfaces`, and `forgeflow/plugins`.
- Added experiment-first structure under `experiments/linear_xy` and `experiments/linear_xy_noisy`.
- Updated `main.py` to call core runner with experiment config (`--config`), defaulting to `experiments/linear_xy/config.json`.
- Moved linear task data/config/output ownership to `experiments/`; removed duplicated copies under `forgeflow/Input`, `forgeflow/config`, and `forgeflow/Output`.
- Added compatibility forwarding in legacy `forgeflow/*` modules so previous imports continue to resolve to the new core implementation.
- Legacy compatibility layer removed after validation; `forgeflow` now keeps only `core/interfaces/plugins` plus `LOG.md`.
- Deleted obsolete files and cache artifacts (`processors.py`, old adapter/metrics/model/config/evaluation wrappers, and `__pycache__` outputs).

## 2026-02-15
- Added split reproducibility controls (`split.shuffle`, `split.seed`) and persisted them in evaluation reports for audit/replay.
- Added chunked inference execution (`infer.chunk_size`) so large inference CSVs can be processed without loading everything into memory at once.
- Improved runtime plugin loading: configs can now use direct class references via `adapter_ref` / `model_ref` (module path), while keeping backward compatibility with registry keys (`adapter` / `model`).
- Updated runner logging to model-capability style output (`summary()` when available, fallback to coefficient shape preview) instead of hardcoded slope/intercept assumptions.
- Added model summaries to built-in linear regressor and app polynomial regressor for consistent pipeline logs.
- Confirmed backward compatibility by running both:
  - `python main.py --config ForgeFlowApps/poly4_cubic/config/run.json`
  - `python main.py --config experiments/linear_xy/config.json`
- Stage assessment: framework is now suitable as a reusable "data -> adapter -> model -> eval -> infer -> report" baseline for new tasks.
- Future direction note: for larger datasets and stronger nonlinear relations, keep current adapter/runner/eval flow and add a PyTorch-based model plugin as an optional model backend.

## 2026-02-17
- Added runtime `mode` support in config (`supervised` default, `simulation` new).
- Extended runtime path contract to support simulation assets (`initial_csv`, `trajectory_csv`) while keeping supervised paths unchanged.
- Split core runner execution into two branches:
  - `supervised`: existing fit/predict/eval/infer flow
  - `simulation`: initial-state loading -> simulator stepping -> trajectory/eval output
- Added simulation adapter and model plugins:
  - `forgeflow/plugins/adapters/dem_grid.py`
  - `forgeflow/plugins/models/diffusion_explicit.py`
- Registered new plugins in `forgeflow/plugins/registry.py` (`dem_grid`, `diffusion_explicit`).
- Added simulation app bundle:
  - `ForgeFlowApps/dem_diffusion/config/run.json`
  - `ForgeFlowApps/dem_diffusion/data/processed/initial.csv`
  - `ForgeFlowApps/dem_diffusion/output/.gitkeep`
- Updated `README.md` with dual-mode docs and simulation quick-run command.
- Moved app-level task implementations for `linear_xy` and `dem_diffusion` into `ForgeFlowApps/`:
  - `ForgeFlowApps/linear_xy/*`
  - `ForgeFlowApps/dem_diffusion/*`
- Updated default entry config in `main.py` to `ForgeFlowApps/linear_xy/config/run.json`.
- Kept `forgeflow/plugins/*` as thin wrappers for backward compatibility with registry-key configs.
- Added root `Makefile` task shortcuts:
  - `run-linear`, `run-dem`, `run-poly4`, `run-solar`, `smoke`
- Verified app runs after migration:
  - `python main.py` (default linear app) -> PASS
  - `python main.py --config ForgeFlowApps/dem_diffusion/config/run.json` -> PASS
  - `python main.py --config ForgeFlowApps/poly4_cubic/config/run.json` -> PASS
  - `python main.py --config experiments/linear_xy/config.json` -> PASS (legacy compatibility)
- Verified make-based execution with MinGW make:
  - `mingw32-make run-linear` -> PASS
  - `mingw32-make -C d:/Github_Repos/ForgeFlow run-poly4` -> PASS
- Reduced mode coupling in runner imports:
  - Moved supervised-only evaluation imports (`metrics/policy/anomaly`) into `_run_supervised`.
  - Made registry imports lazy in `_resolve_adapter_class` / `_resolve_model_class`.
  - Result: `mode=simulation` with `adapter_ref/model_ref` no longer eagerly imports supervised evaluation stack during runner module import.
- Hardened `forgeflow/core/evaluation/__init__.py` with lazy exports (`__getattr__`) so importing the evaluation package no longer eagerly imports numpy-backed metrics.
- Refactored `forgeflow/plugins/registry.py` to store lazy class references (`module:Class`) instead of eager class imports.
- Updated runner registry resolution to load class references on demand, supporting both string and class entries.
- Hardened `forgeflow/plugins/adapters/__init__.py` and `forgeflow/plugins/models/__init__.py` with lazy exports to avoid package-level eager imports.
- Confirmed `mode=simulation` no longer imports numpy even when using registry-key config (`adapter=dem_grid`, `model=diffusion_explicit`).

## 2026-02-18
- Added new app scaffold: `ForgeFlowApps/ink_diffusion/` (config/data/output/README).
- Added simulation config `ForgeFlowApps/ink_diffusion/config/run.json` using:
  - adapter: `ForgeFlowApps.dem_diffusion.adapters.dem_grid_adapter:DEMGridAdapter`
  - model: `ForgeFlowApps.dem_diffusion.models.diffusion_explicit:DiffusionExplicitSimulator`
- Generated Gaussian initial field data: `ForgeFlowApps/ink_diffusion/data/processed/initial.csv` (100x100 grid).
- Verified run:
  - `python main.py --config ForgeFlowApps/ink_diffusion/config/run.json` -> PASS
  - periodic boundary, CFL stable, mass conserved.
- Added Makefile target:
  - `run-ink`
- Added trajectory-to-supervised export script:
  - `ForgeFlowApps/ink_diffusion/scripts/build_supervised_samples.py`
  - exports `step,x,y,h_t,h_t1` from trajectory pairs
- Added Makefile target:
  - `build-ink-samples`
- Added ignore rule for large generated dataset:
  - `ForgeFlowApps/ink_diffusion/data/processed/supervised_samples.csv`
- Verified sample export:
  - `python ForgeFlowApps/ink_diffusion/scripts/build_supervised_samples.py`
  - produced `step_pairs=200`, `rows=2000000`
- Added supervised surrogate learning path for ink diffusion:
  - adapter: `ForgeFlowApps/ink_diffusion/adapters/ink_surrogate_adapter.py`
  - config: `ForgeFlowApps/ink_diffusion/config/surrogate_run.json`
  - uses local 5-point neighborhood features (`h_t`, `h_up`, `h_down`, `h_left`, `h_right`) to predict `h_t1`
- Added surrogate dataset builder:
  - `ForgeFlowApps/ink_diffusion/scripts/build_surrogate_datasets.py`
  - outputs:
    - `ForgeFlowApps/ink_diffusion/data/processed/surrogate_train.csv`
    - `ForgeFlowApps/ink_diffusion/data/processed/surrogate_infer.csv`
  - default build (stride=4) produced:
    - `train_rows=100000`
    - `infer_rows=25000`
- Added Makefile targets:
  - `build-ink-surrogate-data`
  - `run-ink-surrogate`
- Added ignore rules for generated surrogate datasets:
  - `ForgeFlowApps/ink_diffusion/data/processed/surrogate_train.csv`
  - `ForgeFlowApps/ink_diffusion/data/processed/surrogate_infer.csv`
- Verified supervised run:
  - `python main.py --config ForgeFlowApps/ink_diffusion/config/surrogate_run.json` -> PASS
  - `val_mae=0.000000`, `val_rmse=0.000000`, `val_maxae=0.000000`
- Moved ink simulation components to app-local modules (instance-local PDE flow):
  - adapter: `ForgeFlowApps/ink_diffusion/adapters/ink_grid_adapter.py`
  - model: `ForgeFlowApps/ink_diffusion/models/ink_diffusion_explicit.py`
  - config update: `ForgeFlowApps/ink_diffusion/config/run.json` now references local adapter/model.
- Verified after localization:
  - `python main.py --config ForgeFlowApps/ink_diffusion/config/run.json` -> PASS
  - `mingw32-make run-ink` -> PASS
  - `python main.py --config ForgeFlowApps/ink_diffusion/config/surrogate_run.json` -> PASS
- Added visualization report script:
  - `ForgeFlowApps/ink_diffusion/scripts/plot_report.py`
  - outputs:
    - `ForgeFlowApps/ink_diffusion/output/report/simulation_report.png`
    - `ForgeFlowApps/ink_diffusion/output/report/surrogate_report.png`
- Added Makefile target:
  - `plot-ink-report`

## 2026-02-19
- Started "error and convergence" stage for ink diffusion.
- Added time-step convergence study script:
  - `ForgeFlowApps/ink_diffusion/scripts/run_convergence_study.py`
  - runs multiple `dt` cases to same physical end time and compares final grids against the finest-`dt` reference case.
  - outputs per-case CFL/mass checks, L2/Linf errors, and observed order estimates.
- Added Makefile target:
  - `run-ink-convergence`
- Updated docs:
  - `ForgeFlowApps/ink_diffusion/README.md` with convergence command and output file.
  - `README.md` make shortcut list includes `run-ink-convergence`.
- Verified by running:
  - `python ForgeFlowApps/ink_diffusion/scripts/run_convergence_study.py`
- Generated report:
  - `ForgeFlowApps/ink_diffusion/output/convergence_report.csv`
  - default cases (`dt=0.04, 0.02, 0.01`) all `PASS`.
  - observed order (coarse->mid, vs fine reference): `p_l2=1.585616`, `p_linf=1.584169`.
- Added spatial convergence study script:
  - `ForgeFlowApps/ink_diffusion/scripts/run_spatial_convergence_study.py`
  - runs nested grid levels from base initial field (`stride=4,2,1` by default),
    auto-selects `dt` from per-level CFL limit (`cfl_safety`), and compares each
    coarse/fine result to the finest grid reference sampled at matching coordinates.
  - outputs per-level CFL/mass checks, L2/Linf errors, and observed spatial order estimates.
- Added Makefile target:
  - `run-ink-spatial-convergence`
- Updated docs:
  - `ForgeFlowApps/ink_diffusion/README.md` with spatial convergence command and output file.
  - `README.md` make shortcut list includes `run-ink-spatial-convergence`.
- Verified by running:
  - `python ForgeFlowApps/ink_diffusion/scripts/run_spatial_convergence_study.py`
  - `mingw32-make run-ink-spatial-convergence`
- Generated report:
  - `ForgeFlowApps/ink_diffusion/output/spatial_convergence_report.csv`
  - default levels (`stride=4,2,1`) all `PASS`.
  - observed spatial order (coarse->mid, vs fine reference): `p_l2=2.198208`, `p_linf=1.987381`.
- Added framework-level verification module:
  - `forgeflow/core/verification/runner.py`
  - `forgeflow/core/verification/__init__.py`
  - supports config-driven step execution, report status parsing, and summary aggregation.
- Added app verification config:
  - `ForgeFlowApps/ink_diffusion/config/verification.json`
  - steps include `time_convergence`, `spatial_convergence`, and `surrogate_eval`.
- Added Makefile target:
  - `run-ink-verify`
- Updated docs:
  - `ForgeFlowApps/ink_diffusion/README.md` with unified verification command/output.
  - `README.md` make shortcut list includes `run-ink-verify`.
  - `README.md` outputs section notes `verification_summary.csv`.
- Verified end-to-end:
  - `python -m forgeflow.core.verification.runner --config ForgeFlowApps/ink_diffusion/config/verification.json`
  - `mingw32-make run-ink-verify`
- Generated summary:
  - `ForgeFlowApps/ink_diffusion/output/verification_summary.csv`
  - all steps `PASS`, overall `PASS`.
- Upgraded time convergence script with Richardson/triplet observed-order estimation:
  - updated `ForgeFlowApps/ink_diffusion/scripts/run_convergence_study.py`
  - added columns:
    - `observed_order_l2_richardson`
    - `observed_order_linf_richardson`
  - uses adjacent triplets `(dt, dt/r, dt/r^2)` and reports order on middle level.
- Updated app docs:
  - `ForgeFlowApps/ink_diffusion/README.md` now documents reference-order vs Richardson-order fields.
- Expanded app README with a compact variable cheat-sheet and "minimal read path":
  - clarified key physics/numerics fields (`dt`, `dx/dy`, `kappa`, `stable_cfl`, `mass_delta_abs`, `L2/Linf`).
  - marked Richardson order as primary acceptance signal and reference-based order as trend-only.
- Added app-local multi-kappa data generation pipeline:
  - `ForgeFlowApps/ink_diffusion/scripts/build_multi_kappa_trajectories.py`
  - runs simulation for a kappa set, auto-selects stable `dt` by CFL safety, and writes:
    - `ForgeFlowApps/ink_diffusion/output/multi_kappa/trajectory_kappa_*.csv`
    - `ForgeFlowApps/ink_diffusion/output/multi_kappa/manifest.csv`
- Added app-local kappa-aware surrogate dataset builder:
  - `ForgeFlowApps/ink_diffusion/scripts/build_multi_kappa_surrogate_data.py`
  - reads multi-kappa manifest and exports:
    - `ForgeFlowApps/ink_diffusion/data/processed/surrogate_kappa_train.csv`
    - `ForgeFlowApps/ink_diffusion/data/processed/surrogate_kappa_infer_id.csv`
    - `ForgeFlowApps/ink_diffusion/data/processed/surrogate_kappa_infer_ood.csv`
- Added kappa-conditioned adapter and run configs:
  - adapter: `ForgeFlowApps/ink_diffusion/adapters/ink_surrogate_kappa_adapter.py`
  - configs:
    - `ForgeFlowApps/ink_diffusion/config/surrogate_kappa_id_run.json`
    - `ForgeFlowApps/ink_diffusion/config/surrogate_kappa_ood_run.json`
- Added Makefile targets:
  - `build-ink-multi-kappa-trajectories`
  - `build-ink-multi-kappa-data`
  - `run-ink-surrogate-kappa-id`
  - `run-ink-surrogate-kappa-ood`
- Updated docs:
  - `ForgeFlowApps/ink_diffusion/README.md` with multi-kappa generation and kappa-aware surrogate commands.
  - `README.md` quick-run and make shortcuts updated.
- Verified with quick smoke commands:
  - `python ForgeFlowApps/ink_diffusion/scripts/build_multi_kappa_trajectories.py --kappas 0.05 0.1 --total-time 0.4`
  - `python ForgeFlowApps/ink_diffusion/scripts/build_multi_kappa_surrogate_data.py --spatial-stride 10`
  - `python main.py --config ForgeFlowApps/ink_diffusion/config/surrogate_kappa_id_run.json`
  - `python main.py --config ForgeFlowApps/ink_diffusion/config/surrogate_kappa_ood_run.json`
- Added rollout prediction evaluation script:
  - `ForgeFlowApps/ink_diffusion/scripts/run_surrogate_rollout_eval.py`
  - trains surrogate from config train CSV and evaluates multi-step rollout against trajectory truth.
  - writes:
    - `ForgeFlowApps/ink_diffusion/output/surrogate_rollout_steps.csv`
    - `ForgeFlowApps/ink_diffusion/output/surrogate_rollout_summary.csv`
- Added Makefile target:
  - `run-ink-rollout`
- Updated docs:
  - `ForgeFlowApps/ink_diffusion/README.md` rollout commands (base + kappa-aware).
  - `README.md` includes rollout command and make shortcut.
- Verified rollout:
  - `python ForgeFlowApps/ink_diffusion/scripts/run_surrogate_rollout_eval.py --rollout-steps 20`
  - `python ForgeFlowApps/ink_diffusion/scripts/run_surrogate_rollout_eval.py --config ForgeFlowApps/ink_diffusion/config/surrogate_kappa_id_run.json --trajectory ForgeFlowApps/ink_diffusion/output/multi_kappa/trajectory_kappa_0p1.csv --rollout-steps 20`
  - `mingw32-make run-ink-rollout`
- Extended plotting report script:
  - updated `ForgeFlowApps/ink_diffusion/scripts/plot_report.py`
  - added rollout visualization (`rollout_report.png`) from rollout step/summary CSVs.
  - added multi-kappa visualization (`multi_kappa_report.png`) from multi-kappa manifest + trajectory finals.
- Verified plotting:
  - `python ForgeFlowApps/ink_diffusion/scripts/plot_report.py`
  - generated:
    - `ForgeFlowApps/ink_diffusion/output/report/simulation_report.png`
    - `ForgeFlowApps/ink_diffusion/output/report/surrogate_report.png`
    - `ForgeFlowApps/ink_diffusion/output/report/rollout_report.png`
    - `ForgeFlowApps/ink_diffusion/output/report/multi_kappa_report.png`
- Started heat benchmark practice app (step 1: initial condition only):
  - scaffolded `ForgeFlowApps/heat_periodic/` with `data/processed`, `scripts`, `output`.
  - added initial-condition generator:
    - `ForgeFlowApps/heat_periodic/scripts/build_initial_csv.py`
    - analytic init: `u(x,y,0)=sin(2*pi*x)*sin(2*pi*y)`
  - generated:
    - `ForgeFlowApps/heat_periodic/data/processed/initial.csv` (100x100)
- Heat benchmark step 2 started (PDE simulation config):
  - added `ForgeFlowApps/heat_periodic/config/run.json`
  - PDE assumption in this app:
    - `u_t = kappa * (u_xx + u_yy)` with periodic boundary
  - run config currently reuses app-local ink diffusion solver path:
    - adapter: `ForgeFlowApps.ink_diffusion.adapters.ink_grid_adapter:InkGridAdapter`
    - model: `ForgeFlowApps.ink_diffusion.models.ink_diffusion_explicit:InkDiffusionExplicitSimulator`
  - verified run:
    - `python main.py --config ForgeFlowApps/heat_periodic/config/run.json`
    - output files:
      - `ForgeFlowApps/heat_periodic/output/trajectory.csv`
      - `ForgeFlowApps/heat_periodic/output/eval_report.csv`
- Heat benchmark step 3 (app-local adapter):
  - added:
    - `ForgeFlowApps/heat_periodic/adapters/heat_grid_adapter.py`
    - `ForgeFlowApps/heat_periodic/adapters/__init__.py`
  - updated adapter ref in:
    - `ForgeFlowApps/heat_periodic/config/run.json`
  - re-verified run:
    - `python main.py --config ForgeFlowApps/heat_periodic/config/run.json` -> `PASS`
- Heat benchmark step 4 (time convergence vs exact mode):
  - added:
    - `ForgeFlowApps/heat_periodic/scripts/run_exact_convergence_study.py`
  - added Makefile target:
    - `run-heat-exact-convergence`
  - script reports two error views:
    - `*_exact_semidiscrete` (recommended for clean temporal-order check)
    - `*_exact_continuous` (includes fixed spatial bias at current grid spacing)
  - verified:
    - `python ForgeFlowApps/heat_periodic/scripts/run_exact_convergence_study.py`
    - `mingw32-make run-heat-exact-convergence`
  - output:
    - `ForgeFlowApps/heat_periodic/output/exact_convergence_report.csv`
  - observed temporal order (semidiscrete columns):
    - around `p ~= 1.00` for both L2/Linf, matching explicit Euler time order.
- Heat benchmark step 5 (spatial convergence vs exact solution):
  - added:
    - `ForgeFlowApps/heat_periodic/scripts/run_exact_spatial_convergence_study.py`
  - added Makefile target:
    - `run-heat-exact-spatial-convergence`
  - verified:
    - `python ForgeFlowApps/heat_periodic/scripts/run_exact_spatial_convergence_study.py`
    - `mingw32-make run-heat-exact-spatial-convergence`
  - output:
    - `ForgeFlowApps/heat_periodic/output/exact_spatial_convergence_report.csv`
  - observed spatial order on finest pair:
    - around `p_l2 ~= 1.90`, `p_linf ~= 1.90` (close to expected second-order trend).
- Heat benchmark step 6 (supervised surrogate baseline):
  - added dataset builder:
    - `ForgeFlowApps/heat_periodic/scripts/build_surrogate_datasets.py`
  - added adapter:
    - `ForgeFlowApps/heat_periodic/adapters/heat_surrogate_adapter.py`
  - added config:
    - `ForgeFlowApps/heat_periodic/config/surrogate_run.json`
  - added Makefile targets:
    - `build-heat-surrogate-data`
    - `run-heat-surrogate`
  - verified:
    - `python ForgeFlowApps/heat_periodic/scripts/build_surrogate_datasets.py --spatial-stride 5`
    - `python main.py --config ForgeFlowApps/heat_periodic/config/surrogate_run.json`
    - `mingw32-make run-heat-surrogate`
  - run result:
    - `status=PASS`
    - `val_mae=0.000000`
    - `val_rmse=0.000000`
    - `val_maxae=0.000000`
- Heat benchmark step 7 (surrogate rollout prediction):
  - added:
    - `ForgeFlowApps/heat_periodic/scripts/run_surrogate_rollout_eval.py`
  - added Makefile target:
    - `run-heat-rollout`
  - verified:
    - `python ForgeFlowApps/heat_periodic/scripts/run_surrogate_rollout_eval.py --rollout-steps 20`
    - `mingw32-make run-heat-rollout`
  - outputs:
    - `ForgeFlowApps/heat_periodic/output/surrogate_rollout_steps.csv`
    - `ForgeFlowApps/heat_periodic/output/surrogate_rollout_summary.csv`
  - rollout result:
    - `status=PASS`
    - mean/last rollout errors near machine precision for this linear heat setup.
- Heat benchmark step 8 (visual reports):
  - added plotting script:
    - `ForgeFlowApps/heat_periodic/scripts/plot_report.py`
  - added Makefile target:
    - `plot-heat-report`
  - generated plots:
    - `ForgeFlowApps/heat_periodic/output/report/simulation_report.png`
    - `ForgeFlowApps/heat_periodic/output/report/surrogate_report.png`
    - `ForgeFlowApps/heat_periodic/output/report/rollout_report.png`
  - verified:
    - `python ForgeFlowApps/heat_periodic/scripts/plot_report.py`
    - `mingw32-make plot-heat-report`
- Heat benchmark step 9 (long-time visibility update):
  - added/used longer-time config:
    - `ForgeFlowApps/heat_periodic/config/run_long_t.json`
    - total horizon increased via larger `steps * dt` (`1500 * 0.0002 = 0.3`)
  - plotting update:
    - `ForgeFlowApps/heat_periodic/scripts/plot_report.py`
    - simulation snapshots now use a shared color scale (`vmin/vmax`) to make decay visually obvious.
  - Makefile targets added:
    - `run-heat-long`
    - `plot-heat-long`
  - verified:
    - `python main.py --config ForgeFlowApps/heat_periodic/config/run_long_t.json`
    - `python ForgeFlowApps/heat_periodic/scripts/plot_report.py --trajectory ForgeFlowApps/heat_periodic/output/trajectory_long_t.csv --simulation-eval ForgeFlowApps/heat_periodic/output/eval_report_long_t.csv --out-dir ForgeFlowApps/heat_periodic/output/report_long_t`
  - observed:
    - `max|u|` drops from `1.0` at step `0` to about `0.3059` at step `1500`.

## 2026-02-20
- Packaging/reproducibility delivery polish:
  - added dependency file:
    - `requirements.txt` (`numpy`, `matplotlib`)
  - updated root README with a real install-and-run path:
    - added `Quick Start (Install + Run)` section with both `venv` and Conda setup
    - included one sanity command:
      - `python main.py --config ForgeFlowApps/linear_xy/config/run.json`
- New app scaffold: `heat_kappa_inverse` (two-stage inverse workflow):
  - added stage 1 generator:
    - config: `ForgeFlowApps/heat_kappa_inverse/stage1_data_gen/config/generate.json`
    - script: `ForgeFlowApps/heat_kappa_inverse/stage1_data_gen/scripts/build_dataset.py`
    - outputs:
      - `ForgeFlowApps/heat_kappa_inverse/data/processed/train.csv`
      - `ForgeFlowApps/heat_kappa_inverse/data/processed/infer_id.csv`
      - `ForgeFlowApps/heat_kappa_inverse/data/processed/infer_ood.csv`
  - added stage 2 inverse model:
    - adapter: `ForgeFlowApps/heat_kappa_inverse/stage2_inverse/adapters/kappa_inverse_adapter.py`
    - model: `ForgeFlowApps/heat_kappa_inverse/stage2_inverse/models/kappa_linear_regression.py`
    - configs:
      - `ForgeFlowApps/heat_kappa_inverse/stage2_inverse/config/run_id.json`
      - `ForgeFlowApps/heat_kappa_inverse/stage2_inverse/config/run_ood.json`
  - added docs and make targets:
    - `ForgeFlowApps/heat_kappa_inverse/README.md`
    - `build-heat-kappa-data`, `run-heat-kappa-id`, `run-heat-kappa-ood`
  - verified:
    - `python ForgeFlowApps/heat_kappa_inverse/stage1_data_gen/scripts/build_dataset.py`
    - `python main.py --config ForgeFlowApps/heat_kappa_inverse/stage2_inverse/config/run_id.json`
    - `python main.py --config ForgeFlowApps/heat_kappa_inverse/stage2_inverse/config/run_ood.json`
  - observed:
    - ID validation: `val_mae=0.000005`, `val_rmse=0.000006`, `status=PASS`.
- Added infer-side ID/OOD metrics summary for kappa inverse:
  - script:
    - `ForgeFlowApps/heat_kappa_inverse/stage2_inverse/scripts/summarize_infer_metrics.py`
  - output:
    - `ForgeFlowApps/heat_kappa_inverse/output/infer_metrics_report.csv`
  - make target:
    - `report-heat-kappa-infer`
  - purpose:
    - quantify infer quality (`mae/rmse/maxae`) and anomaly ratio on ID vs OOD splits.
- Added noise robustness expansion for heat kappa inverse (1% / 3%):
  - stage1 generator update:
    - `ForgeFlowApps/heat_kappa_inverse/stage1_data_gen/scripts/build_dataset.py`
    - now emits noisy infer sets:
      - `infer_id_noise_0p01.csv`, `infer_id_noise_0p03.csv`
      - `infer_ood_noise_0p01.csv`, `infer_ood_noise_0p03.csv`
    - manifest now records `noise_levels` and `noisy_files`.
  - stage2 configs added:
    - `run_id_noise_0p01.json`, `run_id_noise_0p03.json`
    - `run_ood_noise_0p01.json`, `run_ood_noise_0p03.json`
  - infer summary script upgraded:
    - `summarize_infer_metrics.py` now supports multiple splits and `--skip-missing`.
  - added scatter report script:
    - `ForgeFlowApps/heat_kappa_inverse/stage2_inverse/scripts/plot_kappa_scatter.py`
    - output: `ForgeFlowApps/heat_kappa_inverse/output/kappa_scatter_report.png`
  - make targets added:
    - `run-heat-kappa-id-noise-1`
    - `run-heat-kappa-id-noise-3`
    - `run-heat-kappa-ood-noise-1`
    - `run-heat-kappa-ood-noise-3`
    - `run-heat-kappa-noise-sweep`
    - `plot-heat-kappa-scatter`
  - verified:
    - `mingw32-make build-heat-kappa-data`
    - `mingw32-make run-heat-kappa-id`
    - `mingw32-make run-heat-kappa-ood`
    - `mingw32-make run-heat-kappa-noise-sweep`
- Added automatic markdown summary generator for kappa inverse outputs:
  - script:
    - `ForgeFlowApps/heat_kappa_inverse/stage2_inverse/scripts/generate_summary_md.py`
  - output:
    - `ForgeFlowApps/heat_kappa_inverse/output/summary.md`
  - make target:
    - `report-heat-kappa-summary`
  - integrated into:
    - `run-heat-kappa-noise-sweep`
- Added sigma-threshold calibration sweep for anomaly control:
  - script:
    - `ForgeFlowApps/heat_kappa_inverse/stage2_inverse/scripts/sweep_sigma_k.py`
  - outputs:
    - `ForgeFlowApps/heat_kappa_inverse/output/sigma_k_sweep_report.csv`
    - `ForgeFlowApps/heat_kappa_inverse/output/sigma_k_recommendation.md`
  - make target:
    - `report-heat-kappa-sigma-sweep`
  - integrated into:
    - `run-heat-kappa-noise-sweep`
  - verified:
    - `mingw32-make report-heat-kappa-sigma-sweep`
  - observed:
    - recommended `sigma_k=4.00` under current selection rule.
- Added method formulas to auto summary markdown:
  - updated:
    - `ForgeFlowApps/heat_kappa_inverse/stage2_inverse/scripts/generate_summary_md.py`
  - summary now includes explicit residual/sigma-rule equations:
    - `r = y_true - y_pred`
    - `mu = mean(r_val)`, `sigma = std(r_val)`
    - anomaly if `abs(r - mu) > sigma_k * sigma`
- Documentation polish pass for `heat_kappa_inverse`:
  - updated:
    - `README.md`
    - `ForgeFlowApps/heat_kappa_inverse/README.md`
  - changes:
    - split quick-run docs into minimal clean flow vs full robustness flow.
    - aligned robustness steps with generated artifacts (`summary.md`, sigma sweep outputs).
    - added one-command `mingw32-make run-heat-kappa-noise-sweep` reference in app README.
- New real-data app scaffold: `usgs_water_temp`:
  - added files:
    - `ForgeFlowApps/usgs_water_temp/scripts/build_usgs_dataset.py`
    - `ForgeFlowApps/usgs_water_temp/adapters/usgs_water_temp_adapter.py`
    - `ForgeFlowApps/usgs_water_temp/config/run.json`
    - `ForgeFlowApps/usgs_water_temp/README.md`
  - dataset builder behavior:
    - pulls USGS `daily` items for one site (`parameter_code=00010`, `statistic_id=00003`)
    - builds lagged supervised pairs (`temp_t, doy_sin, doy_cos, dt_days -> y`)
    - writes CSV only:
      - `ForgeFlowApps/usgs_water_temp/data/processed/train.csv`
      - `ForgeFlowApps/usgs_water_temp/data/infer/infer.csv`
  - make/README updates:
    - `Makefile`: `build-usgs-water-temp-data`, `run-usgs-water-temp`
    - `README.md`: added USGS quick-run section
  - verified:
    - `python ForgeFlowApps/usgs_water_temp/scripts/build_usgs_dataset.py --site-id USGS-01491000 --start-date 2023-01-01 --end-date 2025-12-31 --train-until 2024-12-31`
    - `python main.py --config ForgeFlowApps/usgs_water_temp/config/run.json`
  - observed:
    - fetched features: `983`
    - usable daily values (Approved): `754`
    - train rows: `619`
    - infer rows: `134`
    - validation: `val_mae=0.992720`, `val_rmse=1.232003`, `status=PASS`
- USGS feature A/B comparison (temp-only vs seasonal features):
  - added:
    - adapter class: `ForgeFlowApps/usgs_water_temp/adapters/usgs_water_temp_adapter.py` (`USGSWaterTempTempOnlyAdapter`)
    - configs:
      - `ForgeFlowApps/usgs_water_temp/config/run_temp_only.json`
      - `ForgeFlowApps/usgs_water_temp/config/run_full_features.json`
    - report script:
      - `ForgeFlowApps/usgs_water_temp/scripts/compare_feature_sets.py`
    - make targets:
      - `run-usgs-water-temp-temp-only`
      - `run-usgs-water-temp-full-features`
      - `report-usgs-water-temp-ab`
      - `run-usgs-water-temp-ab`
  - verified:
    - `python main.py --config ForgeFlowApps/usgs_water_temp/config/run_temp_only.json`
    - `python main.py --config ForgeFlowApps/usgs_water_temp/config/run_full_features.json`
    - `python ForgeFlowApps/usgs_water_temp/scripts/compare_feature_sets.py`
  - observed (`infer` rows `n=363`, includes provisional):
    - temp-only: `MAE=0.836114`, `RMSE=1.082744`, `MaxAE=3.386629`
    - full-features: `MAE=0.847357`, `RMSE=1.068040`, `MaxAE=2.960343`
    - interpretation:
      - seasonal features reduced `RMSE/MaxAE` but slightly increased `MAE` in this split.
- USGS case summary (CN/EN):
  - Chinese: Completed end-to-end real-data workflow (USGS fetch -> supervised sample build -> linear training -> 2025 inference validation). Error scale is about `1 C`; process is usable. A/B showed better `RMSE/MaxAE` but slightly worse `MAE`, so evidence is moderate.
  - English: Completed end-to-end real-data workflow (USGS fetch -> supervised sample build -> linear training -> 2025 inference validation). Error scale is about `1 C`; process is usable. A/B showed better `RMSE/MaxAE` but slightly worse `MAE`, so evidence is moderate.
- USGS app update for multi-site data preparation:
  - updated:
    - `ForgeFlowApps/usgs_water_temp/scripts/build_usgs_dataset.py`
    - added output overrides `--train-out`, `--infer-out` to avoid overwriting default files during multi-site pulls.
  - generated 3-station datasets (with provisional included):
    - `USGS-01491000`: train `619`, infer `363`
    - `USGS-13192200`: train `731`, infer `364`
    - `USGS-02450250`: train `723`, infer `364`
  - outputs:
    - `ForgeFlowApps/usgs_water_temp/data/processed/train_USGS-*.csv`
    - `ForgeFlowApps/usgs_water_temp/data/infer/infer_USGS-*.csv`
    - `ForgeFlowApps/usgs_water_temp/output/site_pull_v1.csv`
  - docs:
    - `ForgeFlowApps/usgs_water_temp/LOG.md` now includes bilingual (`CN/EN`) v1 summary and multi-site pull record.
- USGS multi-site evaluation pass (3 stations):
  - added:
    - `ForgeFlowApps/usgs_water_temp/scripts/run_multi_site_eval.py`
  - make/README updates:
    - `Makefile`: `run-usgs-water-temp-multi-site`
    - `ForgeFlowApps/usgs_water_temp/README.md`: added multi-site replication section
  - verified:
    - `python ForgeFlowApps/usgs_water_temp/scripts/run_multi_site_eval.py`
  - outputs:
    - `ForgeFlowApps/usgs_water_temp/output/multi_site/site_metrics.csv`
  - observed (infer metrics):
    - `USGS-01491000`: `MAE=0.847357`, `RMSE=1.068040`, `MaxAE=2.960343`
    - `USGS-13192200`: `MAE=0.413245`, `RMSE=0.576381`, `MaxAE=2.422584`
    - `USGS-02450250`: `MAE=0.823036`, `RMSE=1.109144`, `MaxAE=5.165395`
- USGS log polish and phase freeze:
  - updated:
    - `ForgeFlowApps/usgs_water_temp/LOG.md`
  - changes:
    - rewritten as a concise v1 freeze record with clean bilingual conclusions.
    - added explicit phase decision: close linear first-order track and move next to explicit PDE-focused work.
- New app: `heat1d_realistic_predict` (prediction-first realistic PDE benchmark):
  - added:
    - `ForgeFlowApps/heat1d_realistic_predict/config/generate.json`
    - `ForgeFlowApps/heat1d_realistic_predict/scripts/build_dataset.py`
    - `ForgeFlowApps/heat1d_realistic_predict/adapters/heat1d_realistic_adapter.py`
    - `ForgeFlowApps/heat1d_realistic_predict/config/run.json`
    - `ForgeFlowApps/heat1d_realistic_predict/README.md`
    - `ForgeFlowApps/heat1d_realistic_predict/LOG.md`
  - realism features included:
    - spatially varying `kappa(x)`, advection term, source forcing, process noise
    - gaussian + heavy-tail observation noise
    - random/block missing, outliers, stuck sensors, drift, quantization, clipping
  - make targets:
    - `build-heat1d-realistic-data`
    - `run-heat1d-realistic`
  - verified:
    - `python ForgeFlowApps/heat1d_realistic_predict/scripts/build_dataset.py`
    - `python main.py --config ForgeFlowApps/heat1d_realistic_predict/config/run.json`
  - observed:
    - build: `train_rows=8685`, `infer_rows=2853`, `missing_ratio=0.0987`, `stable_cfl=True`
    - eval: `val_mae=0.085073`, `val_rmse=0.245231`, `val_maxae=3.419060`, `status=PASS`
- Added convergence validation for `heat1d_realistic_predict`:
  - added:
    - `ForgeFlowApps/heat1d_realistic_predict/scripts/run_convergence_study.py`
  - make/docs updates:
    - `Makefile`: `run-heat1d-realistic-convergence`
    - `ForgeFlowApps/heat1d_realistic_predict/README.md` step order now includes convergence before training
  - verified:
    - `python ForgeFlowApps/heat1d_realistic_predict/scripts/run_convergence_study.py`
  - observed:
    - temporal order (pseudo-truth `dt_ref=0.015`) around first-order:
      - `dt: 0.24 -> 0.12`: `p_l2=1.1264`, `p_linf=1.1306`
      - `dt: 0.12 -> 0.06`: `p_l2=1.2360`, `p_linf=1.2381`
- Updated `heat1d_realistic_predict` data protocol:
  - `train.csv` / `infer.csv` now keep observed target `y` only (removed `y_true` column) to avoid clean-target leakage in main prediction flow.
  - verified by rebuilding dataset and rerunning:
    - `python ForgeFlowApps/heat1d_realistic_predict/scripts/build_dataset.py`
    - `python main.py --config ForgeFlowApps/heat1d_realistic_predict/config/run.json`
- v2 log freeze polish:
  - updated:
    - `ForgeFlowApps/heat1d_realistic_predict/LOG.md`
  - changes:
    - rewritten to a concise `v2 freeze` format consistent with `v1` style.
    - added explicit phase closure and parallel next-step tracks (applied math + domain datasets).
